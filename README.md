# Рекомендательная система на основе контентного подхода

Проект представлет собой разработку рекомендательной системы для постов юзерам симулированной социальной сети.

### Алгоритм
На вход подается id пользователя, нужно выдать в ответ 5 постов из базы данных, наиболее релевантных для данного юзера.
Метрика оценки - hitrate@5

![image](https://user-images.githubusercontent.com/91482046/218699666-d2208d05-fd93-453e-bfb5-ebb653b6080d.png),

где * n - количество юзеров
* T - количество периодов проверки
* aj(xi, t) - j-ая рекомендация i-ому пользователю в момент времени t;

### Результат
При првоверке на 2000 польщователях, модель показала качество Hitrate@5 = 0.6

### Использованные инструменты

__Модель предсказания__: catboost

__EDA__: python, pandas__, numpy, mathplotlib, seaborn, scikit-learn

__Feature engeneering__: pytorch, transformers, Distilbert

__Бэкэнд-сервис__: FastApi, SQLAlchemy, 

### Входные данные 
<details>
<summary>Описание базы данных</summary>

| Таблица     | Описание                                                                                                          |
|------------:|-------------------------------------------------------------------------------------------------------------------|
|user_data    | описание юзеров (id, пол, возраст, город, страна и др.                                                            |
|post_text_df | описание постов (id, текс, топик (тема))                                                                          |
|feed_post    | содержит историю о просмотренных постах для каждого юзера в изучаемый период (id юзера, id поста, действие (лайк/просмотр), таргет (1 у просмотров, если почти сразу после просмотра был совершен лайк, иначе 0. У действий like пропущенное значение.)                                                                                          |
</details>

### Исследование данных, обучение модели, оценка качества
__recommend_system_EDA+FI.ipynb__ - джупитер ноутбук, содержащий разведовательный анализ данных, генерирование новых фичей на основе текущих данных и текста, обучение и оценку модели

### Рабочие файлы эндпойнта (директория service)
__catboost_model.pkl__ - предобученная модель для предсказаний

__prediction_and_features.py__ - функции выгрузки признаков и модели из базы данных, функция предсказания постов для конкретного пользователя

__database.py__ - код поделючения к базе данных

__schemas.py__ - модели pydentic

__model.py__ - модели SQLAlchemy

__endpoint.py__  - ендпойнт: получаем в качестве запроса id пользователя, формируем фичи для модели, отдаем ей на предсказание, затем возвращаем предсказания и № группы для A/B тестирования

__requirements.txt__ - необходимые библиотеки




